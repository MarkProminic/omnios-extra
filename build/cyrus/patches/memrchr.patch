
Raised as PR upstream - https://github.com/cyrusimap/cyrus-imapd/pull/3172

diff -wpruN '--exclude=*.orig' a~/imap/conversations.c a/imap/conversations.c
--- a~/imap/conversations.c	1970-01-01 00:00:00
+++ a/imap/conversations.c	1970-01-01 00:00:00
@@ -525,7 +525,7 @@ static int check_msgid(const char *msgid
         return IMAP_INVALID_IDENTIFIER;
 
     /* Leniently accept msg-id without @, but refuse multiple @ */
-    if (memchr(msgid, '@', len) != memrchr(msgid, '@', len))
+    if (strchr(msgid, '@') != strrchr(msgid, '@'))
         return IMAP_INVALID_IDENTIFIER;
 
     /* Leniently accept specials, but refuse the outright broken */
